<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Block Shooter</title>
<style>
body {
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #181c24;
  font-family: 'Segoe UI', Arial, sans-serif;
  overflow: hidden;
  touch-action: none;
}

#game-container {
  position: relative;
  background: #232a34;
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  overflow: hidden;
}

#score {
  color: white;
  font-size: 1.3rem;
  font-weight: bold;
  margin-bottom: 10px;
  text-shadow: 0 0 8px #00eaff88;
}

#game-canvas {
  border-radius: 12px;
  background: linear-gradient(180deg, #2d3546 0%, #1a1e26 100%);
  box-shadow: 0 4px 16px rgba(0,0,0,0.5);
}

button {
  background: linear-gradient(90deg, #00eaff 0%, #0077ff 100%);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 12px 32px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 2px 8px #00eaff44;
  transition: all 0.2s ease;
  z-index: 5;
}

button:hover {
  transform: scale(1.05);
  background: linear-gradient(90deg, #0077ff 0%, #00eaff 100%);
}

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(24, 28, 36, 0.97);
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
  text-align: center;
  transition: opacity 0.4s ease;
  z-index: 4;
}

.overlay.hidden {
  opacity: 0;
  pointer-events: none;
}

h1, h2 {
  color: #00eaff;
  text-shadow: 0 0 12px #00eaff99;
  margin: 0;
}

p {
  color: #ccc;
  font-size: 1rem;
  max-width: 280px;
  line-height: 1.4;
}

.menu-buttons {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* Floating music button */
#music-btn {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: rgba(0, 234, 255, 0.15);
  border: 1px solid #00eaff55;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  color: #00eaff;
  box-shadow: 0 0 8px #00eaff44;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 6;
}
#music-btn:hover {
  transform: scale(1.1);
  background: rgba(0, 234, 255, 0.25);
}

/* Touch zones (disabled by default) */
.touch-zone {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 50%;
  opacity: 0;
  z-index: 2;
  pointer-events: none;
}
#left-zone { left: 0; }
#right-zone { right: 0; }
</style>
</head>
<body>
<div id="game-container">
  <div id="score">Score: 0</div>
  <canvas id="game-canvas" width="400" height="600"></canvas>
  <div id="music-btn" title="Toggle Music">ðŸ”Š</div>

  <!-- Main Menu -->
  <div id="menu" class="overlay">
    <h1>Neon Block Shooter</h1>
    <p>Use <b>A</b>/<b>D</b> or tap sides to move.<br>Tap or press <b>F</b> to shoot.</p>
    <div class="menu-buttons">
      <button id="play-btn">Start Game</button>
      <button id="exit-btn">Return to Index</button>
    </div>
  </div>

  <!-- Game Over -->
  <div id="game-over" class="overlay hidden">
    <h2>Game Over</h2>
    <p id="final-score">Score: 0</p>
    <div class="menu-buttons">
      <button id="restart-btn">Restart</button>
      <button id="menu-btn">Back to Menu</button>
      <button id="exit-btn-over">Return to Index</button>
    </div>
  </div>

  <!-- Touch controls -->
  <div id="left-zone" class="touch-zone"></div>
  <div id="right-zone" class="touch-zone"></div>
</div>

<script>
const canvas = document.getElementById("game-canvas");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const menu = document.getElementById("menu");
const gameOverScreen = document.getElementById("game-over");
const playBtn = document.getElementById("play-btn");
const restartBtn = document.getElementById("restart-btn");
const menuBtn = document.getElementById("menu-btn");
const finalScoreEl = document.getElementById("final-score");
const exitBtns = [document.getElementById("exit-btn"), document.getElementById("exit-btn-over")];
const leftZone = document.getElementById("left-zone");
const rightZone = document.getElementById("right-zone");
const musicBtn = document.getElementById("music-btn");

const music = new Audio("Music.mp3");
music.loop = true;
music.volume = 0.3;
let musicMuted = false;

musicBtn.onclick = () => {
  musicMuted = !musicMuted;
  if (musicMuted) {
    musicBtn.textContent = "ðŸ”‡";
    fadeOutMusic();
  } else {
    musicBtn.textContent = "ðŸ”Š";
    playMusic();
  }
};

function playMusic() {
  if (!musicMuted) music.play().catch(()=>{});
}
function fadeOutMusic() {
  let vol = music.volume;
  const fade = setInterval(() => {
    vol -= 0.05;
    music.volume = Math.max(vol, 0);
    if (vol <= 0) {
      clearInterval(fade);
      music.pause();
      music.volume = 0.3;
    }
  }, 80);
}

const player = { x: 175, y: 540, width: 50, height: 20, speed: 7 };
let bullets = [];
let blocks = [];
let score = 0;
let gameActive = false;
let leftPressed = false, rightPressed = false;
let spawnTimer = 0;
let lastTime = 0;

function spawnBlock() {
  const width = 60, height = 30;
  const x = Math.random() * (canvas.width - width);
  const color = `hsl(${Math.random()*360}, 80%, 60%)`;
  blocks.push({ x, y: -height, width, height, color });
}

function shoot() {
  bullets.push({ x: player.x + player.width/2 - 4, y: player.y - 16, width: 8, height: 16, speed: 10 });
}

function update(dt) {
  if (leftPressed) player.x -= player.speed * dt * 60;
  if (rightPressed) player.x += player.speed * dt * 60;
  player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));

  bullets.forEach(b => b.y -= b.speed * dt * 60);
  bullets = bullets.filter(b => b.y > -20);

  blocks.forEach(b => b.y += (2 + score * 0.02) * dt * 60);
  blocks = blocks.filter(b => b.y < canvas.height + 50);

  bullets.forEach((b, bi) => {
    blocks.forEach((bl, blki) => {
      if (b.x < bl.x + bl.width && b.x + b.width > bl.x && b.y < bl.y + bl.height && b.y + b.height > bl.y) {
        bullets.splice(bi, 1);
        blocks.splice(blki, 1);
        score++;
        scoreEl.textContent = "Score: " + score;
      }
    });
  });

  if (blocks.some(b => b.y + b.height >= player.y && b.x < player.x + player.width && b.x + b.width > player.x)) {
    endGame();
  }

  spawnTimer += dt * 60;
  if (spawnTimer > Math.max(60 - score, 20)) {
    spawnBlock();
    spawnTimer = 0;
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#00eaff";
  ctx.shadowColor = "#00eaff";
  ctx.shadowBlur = 10;
  ctx.fillRect(player.x, player.y, player.width, player.height);
  ctx.shadowBlur = 0;
  ctx.fillStyle = "#fff";
  bullets.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));
  blocks.forEach(b => {
    ctx.fillStyle = b.color;
    ctx.fillRect(b.x, b.y, b.width, b.height);
  });
}

function loop(timestamp) {
  if (!gameActive) return;
  const dt = (timestamp - lastTime) / 1000 || 0.016;
  lastTime = timestamp;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}

function startGame() {
  score = 0;
  bullets = [];
  blocks = [];
  player.x = 175;
  scoreEl.textContent = "Score: 0";
  menu.classList.add("hidden");
  gameOverScreen.classList.add("hidden");
  gameActive = true;
  enableTouchZones(true);
  playMusic();
  lastTime = performance.now();
  requestAnimationFrame(loop);
}

function endGame() {
  gameActive = false;
  enableTouchZones(false);
  finalScoreEl.textContent = "Score: " + score;
  gameOverScreen.classList.remove("hidden");
}

function backToMenu() {
  gameActive = false;
  enableTouchZones(false);
  menu.classList.remove("hidden");
  gameOverScreen.classList.add("hidden");
}

function enableTouchZones(enable) {
  const state = enable ? "auto" : "none";
  leftZone.style.pointerEvents = state;
  rightZone.style.pointerEvents = state;
}

// Controls
document.addEventListener("keydown", e => {
  if (e.code === "KeyA") leftPressed = true;
  if (e.code === "KeyD") rightPressed = true;
  if ((e.code === "KeyF" || e.code === "Space") && gameActive) shoot();
});
document.addEventListener("keyup", e => {
  if (e.code === "KeyA") leftPressed = false;
  if (e.code === "KeyD") rightPressed = false;
});

// Touch controls
[leftZone, rightZone, canvas].forEach(zone => {
  zone.addEventListener("touchstart", e => e.preventDefault(), { passive: false });
});
leftZone.addEventListener("touchstart", e => { e.preventDefault(); leftPressed = true; });
leftZone.addEventListener("touchend", e => { e.preventDefault(); leftPressed = false; });
rightZone.addEventListener("touchstart", e => { e.preventDefault(); rightPressed = true; });
rightZone.addEventListener("touchend", e => { e.preventDefault(); rightPressed = false; });
canvas.addEventListener("touchstart", e => { e.preventDefault(); if (gameActive) shoot(); });

// Buttons
playBtn.onclick = startGame;
restartBtn.onclick = startGame;
menuBtn.onclick = backToMenu;
exitBtns.forEach(btn => btn.onclick = () => window.location.href = "index.html");
</script>
</body>
</html>
